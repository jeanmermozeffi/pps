$(function(){function a(a,s){(s=void 0===s||!!s)?($("#page-loader").removeClass("display-none"),$("#content-inner").load(`${a} #page-content-wrapper`,()=>{$("#page-loader").addClass("display-none"),$(".alert-flash").slideUp(3e3)})):document.location.href=a}$(".readonly-form").find("input").prop({readonly:!0,disabled:!0}),$("body").on("hidden.bs.modal",".modal",function(){$(this).removeData("bs.modal")}),$(document).on("click",".btn-ajax",function(s){s.preventDefault();const e=$(this),o=e.closest("form"),l=(o.attr("id"),o.find(".loader")),d=e.closest(".modal");o.ajaxSubmit({cache:!1,beforeSend:()=>{l.removeClass("hide")},complete:()=>{l.addClass("hide")},success:(s,e,o,l)=>{const t='<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>',n=s.message,r=s.redirect;if(s.statut)if($(".ajax-success",l).removeClass("hide").html(t+n),$(".ajax-error",l).addClass("hide"),-1===r.indexOf("#"))!d.length||void 0!==s.modal&&!1!==s.modal||d.modal("toggle"),a(r,s.ajax||!0);else{const[a,s]=r.split("#");s==d.attr("id")&&d.removeClass("reload-page").modal("hide"),$("#"+s).modal("toggle");const e=localStorage.getItem("psm__grid_hash"),o=$("#grid-wrapper-"+e,d);if(d.addClass("reload-page"),o.length){const s=o.find(".grid-overlay");s.removeClass("display-none"),d.find("#grid-wrapper-"+e).load(a+" #grid-table-"+e,function(){s.addClass("display-none")})}}else{let a="";Array.isArray(n)?n.forEach(s=>{Array.isArray(n)||(a+=s)}):a=n,$(".ajax-error",l).removeClass("hide").html(t+a),$(".ajax-success",l).addClass("hide");var i=$(".ajax-error",l).position().top;d.length?d.scrollTop(i):$(document).scrollTop(i)}},error:a=>{$(".ajax-error",o).removeClass("hide").html("Erreur interne du serveur"),$(".ajax-success",o).addClass("hide"),d.scrollTop($(".ajax-error").position().top)}})}).on("click",".prevent-default",function(a){a.preventDefault()}),$(".modal").on("hidden.bs.modal",function(a){const s=$(this);$(a.currentTarget).is(s)&&s.hasClass("in")}),$(".modal").on("hide.bs.modal",function(s){const e=$(this);"full"!=e.attr("id")&&e.find(".modal-dialog").removeClass("modal-full"),e.find(".modal-dialog").removeClass("modal-sm").addClass("modal-lg"),"stack2"==e.attr("id")&&e.find(".modal-dialog").removeClass("modal-lg");const o=`\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>\n                </div>\n                <div class="modal-body text-center">\n                    <img src="${loader_path}" alt="" class="loading">\n                    <span> &nbsp;&nbsp;Chargement des donn√©es... </span>\n                </div>\n            `;e.find(".modal-content").html("").append(o),e.hasClass("reload-page")&&(e.removeClass("reload-page"),a(current_url),$(".alert-flash").remove())}),$(".modal").on("show.bs.modal",function(a){const s=$(a.relatedTarget),e=$(this);(s.hasClass("has-full-modal")||s.hasClass("modal-full"))&&$(this).find(".modal-dialog").addClass("modal-full"),s.hasClass("has-lg-modal")&&e.find(".modal-dialog").addClass("modal-lg"),s.hasClass("has-sm-modal")&&e.find(".modal-dialog").addClass("modal-sm")}),$(".modal").on("shown.bs.modal",function(a){const s=$(this);localStorage.setItem("current_modal_id",s.attr("id"))}),$(document).ajaxStart(function(a){}).ajaxError(function(a){}).ajaxComplete(function(){setUserFields()})});